services:
  # OCI 서버는 GHCR 이미지를 pull 해서 백엔드만 배포한다.
  backend:
    image: ${BACKEND_IMAGE:-ghcr.io/ohseonghyeon/mocktalkback:prod-latest}
    pull_policy: always
    container_name: mocktalk-back
    env_file:
      - ./.env.prod
    # 앱/매트릭 포트는 로컬 루프백으로만 바인딩한다.
    # 외부 공개는 경유를 전제로 한다.
    ports:
      - "127.0.0.1:8082:8082"
      - "127.0.0.1:8083:8083"
    restart: unless-stopped
